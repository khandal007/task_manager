<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
  <link rel="stylesheet" href="/resources/demos/style.css">
  <link href='https://fonts.googleapis.com/css?family=Sofia' rel='stylesheet'>
  <link href = "https://code.jquery.com/ui/1.10.4/themes/ui-lightness/jquery-ui.css"
         rel = "stylesheet">
  <script src = "https://code.jquery.com/jquery-1.10.2.js"></script>
  <script src = "https://code.jquery.com/ui/1.10.4/jquery-ui.js"></script>
      <link href="http://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.0.3/css/bootstrap.min.css"
        rel="stylesheet" type="text/css" />
    <script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.0.3/js/bootstrap.min.js"></script>
    <link href="http://cdn.rawgit.com/davidstutz/bootstrap-multiselect/master/dist/css/bootstrap-multiselect.css"
        rel="stylesheet" type="text/css" />
    <script src="http://cdn.rawgit.com/davidstutz/bootstrap-multiselect/master/dist/js/bootstrap-multiselect.js"
        type="text/javascript"></script>
    <script type="text/javascript">
        $(function () {
            $('#tech').multiselect({
                includeSelectAllOption: true
            });
            
        });
    </script>
    <script type="text/javascript">
        $(function () {
            $('#team').multiselect({
                includeSelectAllOption: true
            });
            
        });
    </script>
  <style type="text/css">
    
  * { box-sizing:border-box;}
  body { margin:0; width:100%; height:100%;}
  html { width:100%; height:100%;}
  .backpic { position:absolute; top:45%; left:25%; height:50%; width:60%; background:url("header.jpg") no-repeat fixed; background-size:cover;}
  .outerbox { width:40%; padding:0; padding-bottom:15px; border:1px solid #aaa; border-radius:4px; position:absolute; top:10%; left:30%; z-index:99; background-color:rgba(255,255,255,1); box-shadow: 5px 5px 5px grey;}
  .name, .boxAddProject, .allselect, .details { display:flex;}
  .name > input { width:40%; border:none; border-bottom:1px solid #888; padding:5px;}
  .boxAddProject > input { width:40%; border:none; border-bottom:1px solid #888; padding:5px;}
  .allselect { width:96%; display:inline-block; margin-top:10px; margin-left:38px; height:50px; border:none; padding:5px;}
  .details > textarea { width:100%; padding:5px;}
  .header { background-color:#ff6e4a; color:white;}
  h1 { text-align:center; margin:0; padding:25px;}
  .name1{ height:25px; width:25px; position:absolute; top:21.2%; left:85.5%; z-index:999;}
  .img1 { height:25px; width:25px; position:absolute; top:32%; left:85.5%; z-index:999;}
  .labelDetails { padding:25px 0 0 40px; z-index:11;}
  #name { margin-left:40px; margin-top:35px; margin-right:10px; padding:5px;}
  #sdate { margin-right:40px; margin-top:35px; margin-left: 10px; padding:5px; border:none; border-bottom:1px solid #888;}
  #release { margin-left:40px; margin-top:35px; margin-right:10px; padding:5px;}
  #edate { margin-right:40px; margin-top:35px; margin-left: 15px; padding:5px; border:none; border-bottom:1px solid #888;}
  #team { margin-left:40px; margin-top:25px; margin-right:10px; padding:5px;}
  #tech { margin-right:40px; margin-top:25px; margin-left: 10px; padding:5px;}
  .details { margin:5px 40px 15px 40px;}
  .button { margin: 25px 20px 45px 20px; width:200px; height:38px;}
  .submit { float:right; background-color:#c70745; border:none; font-size:12px; text-transform:uppercase; font-weight:bolder; color:white; cursor:pointer;}
  .cancel { background-color:teal; display:inline-block; border:none; text-transform:uppercase; font-weight:bold; color:white; cursor:pointer; text-decoration:none; font-size:12px; text-align:center; padding:13px;}
.btn-group
{
  width:45%;
  height: 50px;
  vertical-align:middle;
  border:1px solid black;
      position: relative;
    display: inline-block;
    border:none;
    border:1px solid #ccc;
}
.btn{
    width:100%;
    display: inline-block;
    padding: 6px 12px;
    margin-bottom: 0;
    font-size: 16 px;
    font-weight: normal;
    line-height: 1.428571429;
    text-align: left;
    white-space: nowrap;
    vertical-align: middle;
    cursor: pointer;
    background-image: none;
    border: 1px solid transparent;
    border-radius: 4px;
    user-select: none
  }
  .multiselect { height:48px; border-radius:unset;} 
  .dropdown-toggle { height:48px; border-radius:unset;}
  .btn { height:48px; border-radius:unset;}
  .btn-default { height:48px; border-radius:unset;}
  .btn .caret { margin-left:140px;}
  .caret { width:0; height:0; margin-left:2px; vertical-align:middle; border-top:10px solid; border-right:6px solid transparent; border-left:6px solid transparent;}
  @media screen and (max-width:1350) {
    .Label1 { margin-left:21px margin-top:10px;}
    #sdate { margin-right:40px; margin-top:0; margin-left: 10px; padding:5px; border:none; border-bottom:1px solid #888;}
    #edate { margin-right:40px; margin-top:0; margin-left: 15px; padding:5px; border:none; border-bottom:1px solid #888;}
  
  }
  </style>
</head>
<body>
    <div  class="outerbox">
      <div class="header">
        <h1>Add Project</h1>
        </div>
        <div>
          <form id="idForm" method="post">
            <div>
              <div class="name">
                <input type="text" id="name" name="name" placeholder="Project Name" required>
                <div>
                  <label for="from" class="Label1">Start Date:</label>
                  <input type="text" id="sdate" name="startDate" required><br>
                  <img src="/images/calendar.jpg" class="name1">
                </div>
              </div>
              <div class="boxAddProject">
                  <input type="text" id="release" name="release" placeholder="Release" required>
                  <div>
                  <label for="to" class="Label1">End Date:</label>
                  <input type="text" id="edate" name="endDate" placeholder="enddate" required><br>
                  <img src="/images/calendar.jpg" class="img1">
                  </div>
              </div>
              <div class="allselect">
                <label>Select Team-Members:</label>
                <label style="position:relative; left:120px;">Select Technology:</label><br>
                <select name="teamMember" id="team" multiple required>
                  <% for(var i=0; i < teamData.length; i++){%>
                  <option  value="<%= teamData[i].name %>"><%= teamData[i].name %></option>
                  <%}%>
                </select>
                <select name="technology" id="tech" multiple required>
                  <% for(var i=0; i < techData.length; i++){%>
                  <option  value="<%= techData[i].name %>"><%= techData[i].name %></option>
                  <%}%>
                </select>
              </div>
              <label for="details" class="labelDetails">Details:</label>
              <div class="details"> 
                <textarea name="details" id="details" rows="5" cols="60" placeholder="Details" required></textarea>
              </div>
              <div class="buttons">
                <input type="hidden" id="id" name="parent_id" value="<%= data %>">
                <a class="cancel button" href="home">Cancel</a>
                <input type="submit" value="Submit" class="submit button">
              </div>
            </div>  
        </form>
    </div>
  </div>
<script>
/*$("input").on("change", function() {
    this.setAttribute(
        "data-date",
        (this.value, "YYYY/MM/DD")
        .format( this.getAttribute("data-date-format") )
    )
}).trigger("change")
*/
$(document).ready(function(){

$("#idForm").submit(function(e) {
//alert("submit");
 e.preventDefault(); // avoid to execute the actual submit of the form.
if(date1() == false){
  alert("The Start Date must be bigger or Equal to main Project");
  return false;
}

if(date2() == false){
  alert("The End Date must be lesser or Equal to main Project");
  return false;
}

if(date_validate() == false){
  alert("The End Date must be greater or Equal to start date");
  return false;
}

 date2();
 date1();
 date_validate();
console.log(date1());
 var form = $(this);
 //var url = form.attr('action');

     $.ajax({
            type: "POST",
            url: '/pDetails/create',
            data: form.serialize(), // serializes the form's elements.
            success: function(data)
            {
                alert("Successfully Created !"); 
                location.href="/home"; // show response from the php script.
            }
     });
});
})
function getParam( name )
{
 name = name.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");
 var regexS = "[\\?&]"+name+"=([^&#]*)";
 var regex = new RegExp( regexS );
 var results = regex.exec( window.location.href );
 if( results == null )
  return "";
else
 return results[1];
}

var st_param = getParam( 'stDate' );
var ed_param = getParam( 'edDate' );

console.log(st_param);
console.log(ed_param);

function date1() {
    var sDate = document.getElementById("sdate").value;
    var ToDate = new Date(st_param);

    if (new Date(sDate).getTime() < ToDate.getTime()) {
      return false;
    } 
    return true;
}
function date2() {

  var eDate = document.getElementById("edate").value;
    var ForDate = new Date(ed_param);

    if (new Date(eDate).getTime() > ForDate.getTime()) {
      
      return false;
    }
    return true;
}

    function date_validate () {
    var startDate = document.getElementById("sdate").value;
    var endDate = document.getElementById("edate").value;

    if ((Date.parse(startDate) > Date.parse(endDate))) {
        return false;
    }
    return true;
}

</script>

  <script>
         /*$(function() {
            $( "#sdate" ).datepicker({
    dateFormat: "yy-mm-dd"}).datepicker("setDate", "today");
            //$( "#edate" ).datepicker();
            //$( "#edate" ).datepicker("setDate", "today");
            $("#edate" ).datepicker({
    dateFormat: "yy-mm-dd",
    //showOtherMonths: true,
    //selectOtherMonths: true,
    //changeMonth: true,
    //changeYear: true,
    minDate: startdate,
    //maxDate: 'stdate' ,
         }).datepicker("setDate", "today");
         });*/
    </script>

  <script type="text/javascript">
    $("#sdate").datepicker({ dateFormat: 'yy-mm-dd' });
    $("#edate").datepicker({ dateFormat: 'yy-mm-dd' });
  </script>
      <script>

  $( function() {
    var dateFormat = "mm/dd/yy",
      from = $( "#sdate" )
        .datepicker({
          defaultDate: "+1w",
        })
        .on( "change", function() {
          to.datepicker( "option", "minDate", getDate( this ) );
        }).datepicker("setDate", "today"),
      to = $( "#edate" ).datepicker({
        defaultDate: "+1w",
      })
      .on( "change", function() {
        from.datepicker( "option", "maxDate", getDate( this ) );
      }).datepicker("setDate", "today");
 
    function getDate( element ) {
      var date;
      try {
        date = $.datepicker.parseDate( dateFormat, element.value );
      } catch( error ) {
        date = null;
      }
 
      return date;
    }
  } );
  </script>
  <script type="text/javascript">
   // $('input,textarea,select').filter('[required]:visible');
  </script>
</body>
</html>